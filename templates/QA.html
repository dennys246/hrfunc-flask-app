{% extends "base.html" %}

{% block title %}Home | HRfunc{% endblock %}

{% block content %}

<div class="py-16 px-6 md:px-10 max-w-6xl mx-auto mt-10 text-gray-800 dark:text-gray-100">
  <h1 class="text-3xl font-semibold text-center text-indigo-700 dark:text-indigo-300">Q &amp; A</h1>

  <div class="space-y-6 mt-10">
    <section class="glass-card accordion-panel">
      <button type="button" class="accordion-trigger" onclick="toggleAccordion(this)">
        <span>What is HR<i><span style="font-family: 'Times New Roman', serif;">func</span></i>?</span>
        <svg class="accordion-icon text-indigo-600 dark:text-indigo-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
      </button>
      <div class="accordion-content hidden space-y-4">
        <p>
          HR<i><span style="font-family: 'Times New Roman', serif;">func</span></i> is a Python library for estimating neural activity and hemodynamic response functions (HRFs)
          in functional near infrared spectroscopy (fNIRS) data. It builds on top of the MNE ecosystem so you
          can move seamlessly between preprocessing, deconvolution, and downstream analysis. Explore the
          <a href="/hrfunc_guide">tutorial page</a> for a walkthrough and video guide.
        </p>
      </div>
    </section>

    <section class="glass-card accordion-panel">
      <button type="button" class="accordion-trigger" onclick="toggleAccordion(this)">
        <span>How do I install HR<i><span style="font-family: 'Times New Roman', serif;">func</span></i>?</span>
        <svg class="accordion-icon text-indigo-600 dark:text-indigo-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
      </button>
      <div class="accordion-content hidden space-y-4">
        <p>
          Install HR<i><span style="font-family: 'Times New Roman', serif;">func</span></i> from PyPI with Python 3.8 or later:
        </p>
        <p><code>pip install hrfunc</code></p>
        <p>
          The installer pulls in the required scientific stack, including <code>mne</code>, so you can
          immediately load NIRx scans, configure montages, and start estimating HRFs.
        </p>
      </div>
    </section>

    <section class="glass-card accordion-panel">
      <button type="button" class="accordion-trigger" onclick="toggleAccordion(this)">
        <span>How do I use the HR<i><span style="font-family: 'Times New Roman', serif;">func</span></i> tool?</span>
        <svg class="accordion-icon text-indigo-600 dark:text-indigo-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
      </button>
      <div class="accordion-content hidden space-y-4">
        <p>Typical workflows follow four stages:</p>
        <ol class="list-decimal list-inside space-y-2">
          <li>Load raw fNIRS scans through MNE and prepare event timing.</li>
          <li>(Optional) Estimate subject-level HRFs for each participant.</li>
          <li>(Optional) Aggregate subject estimates into a group HRF distribution.</li>
          <li>Estimate neural activity channel-by-channel for every subject.</li>
        </ol>
        <p>
          Subject-level HRFs require an event-based paradigm. Without events, rely on a canonical HRF or
          browse the <a href="/hrtree_guide">HR<i><span style="font-family: 'Times New Roman', serif;">tree</span></i></a> for context-matched estimates contributed by the community.
          The <a href="/hrfunc_guide">HR<i><span style="font-family: 'Times New Roman', serif;">func</span></i> guide</a> walks through each stage in detail.
        </p>
      </div>
    </section>

    <section class="glass-card accordion-panel">
      <button type="button" class="accordion-trigger" onclick="toggleAccordion(this)">
        <span>What is the HR<i><span style="font-family: 'Times New Roman', serif;">tree</span></i>?</span>
        <svg class="accordion-icon text-indigo-600 dark:text-indigo-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
      </button>
      <div class="accordion-content hidden space-y-4">
        <p>
          The HR<i><span style="font-family: 'Times New Roman', serif;">tree</span></i> is a growing database of HRF estimates submitted by researchers. Each entry is tagged with
          detailed experimental context—age range, task, stimulus modality, protocol, demographics, and more—so
          you can locate HRFs that align with your study. The backend combines tree and hash structures to make
          filtering and spatial lookups fast.
        </p>
      </div>
    </section>

    <section class="glass-card accordion-panel">
      <button type="button" class="accordion-trigger" onclick="toggleAccordion(this)">
        <span>How can I submit my estimated HRFs to the HR<i><span style="font-family: 'Times New Roman', serif;">tree</span></i>?</span>
        <svg class="accordion-icon text-indigo-600 dark:text-indigo-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
      </button>
      <div class="accordion-content hidden space-y-4">
        <p>
          Once you have HRFs estimated with HR<i><span style="font-family: 'Times New Roman', serif;">func</span></i> and a DOI-linked paper detailing data collection, head to the
          <a href="/hrf_upload">HRF submission page</a>. After a light review, your HRFs enter the HR<i><span style="font-family: 'Times New Roman', serif;">tree</span></i> so other
          labs can explore them alongside the metadata you provide.
        </p>
      </div>
    </section>

    <section class="glass-card accordion-panel">
      <button type="button" class="accordion-trigger" onclick="toggleAccordion(this)">
        <span>What is an experimental context?</span>
        <svg class="accordion-icon text-indigo-600 dark:text-indigo-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
      </button>
      <div class="accordion-content hidden space-y-4">
        <p>
          Experimental contexts are descriptors that capture the conditions under which an HRF was derived—think
          task, stimulus intensity, medium, age range, demographics, health status, and more. Supplying these
          details keeps the HR<i><span style="font-family: 'Times New Roman', serif;">tree</span></i> searchable and lets teams identify HRFs that match their paradigm.
          Explore the <a href="/experimental_contexts">context reference</a> for the current vocabulary.
        </p>
      </div>
    </section>

    <section class="glass-card accordion-panel">
      <button type="button" class="accordion-trigger" onclick="toggleAccordion(this)">
        <span>How are HRFs and neural activity estimated?</span>
        <svg class="accordion-icon text-indigo-600 dark:text-indigo-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
      </button>
      <div class="accordion-content hidden space-y-4">
        <p>
          HR<i><span style="font-family: 'Times New Roman', serif;">func</span></i> performs Toeplitz deconvolution with ridge regularization. The library handles preprocessing,
          edge expansion, and aggregation so you can recover subject-level HRFs and replace hemoglobin traces
          with estimated neural activity. Curious about extending the pipeline—perhaps with Bayesian approaches?
          Fork the project on <a href="https://github.com/dennys246/HRFunc" rel="noopener" target="_blank">GitHub</a>
          and experiment with custom estimators.
        </p>
      </div>
    </section>

    <section class="glass-card accordion-panel">
      <button type="button" class="accordion-trigger" onclick="toggleAccordion(this)">
        <span>Why does my HRF show high variability near the edges?</span>
        <svg class="accordion-icon text-indigo-600 dark:text-indigo-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
      </button>
      <div class="accordion-content hidden space-y-4">
        <p>
          Toeplitz deconvolution can introduce edge artifacts. HR<i><span style="font-family: 'Times New Roman', serif;">func</span></i> mitigates this with edge expansion—temporarily
          extending the estimation window and trimming excess samples after inversion. If residual variability remains,
          increase the <code>edge_expansion</code> parameter when calling <code>montage.estimate_hrfs()</code>.
        </p>
      </div>
    </section>

    <section class="glass-card accordion-panel">
      <button type="button" class="accordion-trigger" onclick="toggleAccordion(this)">
        <span>Can I reuse HRFs from one study in another?</span>
        <svg class="accordion-icon text-indigo-600 dark:text-indigo-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
      </button>
      <div class="accordion-content hidden space-y-4">
        <p>
          Yes—reusing HRFs is a major advantage of HR<i><span style="font-family: 'Times New Roman', serif;">func</span></i>, especially when multiple projects share the same montage.
          Still, weigh differences in paradigm, population, or stimuli that might shift the underlying hemodynamics.
          If the contexts diverge, consider browsing the <a href="/hrtree_guide">HR<i><span style="font-family: 'Times New Roman', serif;">tree</span></i></a> or reverting to the
          canonical HRF for a safer baseline.
        </p>
      </div>
    </section>

    <section class="glass-card accordion-panel">
      <button type="button" class="accordion-trigger" onclick="toggleAccordion(this)">
        <span>What are the requirements for uploading an HRF estimate?</span>
        <svg class="accordion-icon text-indigo-600 dark:text-indigo-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
      </button>
      <div class="accordion-content hidden space-y-4">
        <p>
          Uploads should originate from the HR<i><span style="font-family: 'Times New Roman', serif;">func</span></i> pipeline (extensions welcome if documented) and reference a DOI
          describing data collection. We especially encourage subset HRFs—unique demographic groups, age brackets,
          or task variants help everyone run richer cross-study analyses. Share yours through the
          <a href="/hrf_upload">submission form</a>.
        </p>
      </div>
    </section>
  </div>
</div>

<script>
function toggleAccordion(button) {
  const panel = button.closest('.accordion-panel');
  const content = panel.querySelector('.accordion-content');

  if (!content) {
    return;
  }

  const isOpen = !content.classList.contains('hidden');
  content.classList.toggle('hidden');
  panel.classList.toggle('open', !isOpen);
}
</script>

{% endblock %}
