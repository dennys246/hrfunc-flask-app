{% extends "base.html" %}

{% block title %}Home | HRfunc{% endblock %}

{% block body_class %}home-body{% endblock %}

{% block seo %}
  {% set meta_description = "HRfunc is the home for hemodynamic response function estimation, with a practical guide and an easy HRF upload portal for researchers." %}
  <meta name="description" content="{{ meta_description }}">
  <meta property="og:title" content="HRfunc | Hemodynamics and Neural Activity">
  <meta property="og:description" content="{{ meta_description }}">
  <meta property="og:url" content="{{ canonical_url|default(default_canonical) }}">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="HRfunc | Hemodynamics and Neural Activity">
  <meta name="twitter:description" content="{{ meta_description }}">
  {% set structured_data = {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "HRfunc",
    "url": site_home_url,
    "description": meta_description,
    "inLanguage": "en",
    "hasPart": [
      {
        "@type": "WebPage",
        "name": "HRfunc guide",
        "url": url_for('hrfunc_guide', _external=True)
      },
      {
        "@type": "WebPage",
        "name": "HRF upload",
        "url": url_for('hrf_upload', _external=True)
      }
    ],
    "potentialAction": [
      {
        "@type": "ViewAction",
        "target": url_for('hrfunc_guide', _external=True),
        "name": "HRfunc guide"
      },
      {
        "@type": "ViewAction",
        "target": url_for('hrf_upload', _external=True),
        "name": "HRF upload"
      }
    ]
  } %}
  <script type="application/ld+json">{{ structured_data | tojson }}</script>
{% endblock %}

{% block scripts %}
  {{ super() }}
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const docEl = document.documentElement;
      const hero = document.querySelector('.index-hero');
      const header = document.querySelector('.site-header');
      const footer = document.querySelector('.site-footer');

      function syncHeroHeight() {
        const headerHeight = header && header.offsetHeight ? header.offsetHeight : 0;
        const footerHeight = footer && footer.offsetHeight ? footer.offsetHeight : 0;
        const viewportHeight = window.innerHeight || docEl.clientHeight || 0;
        const chromeHeight = headerHeight + footerHeight;

        docEl.style.setProperty('--chrome-height', `${chromeHeight}px`);
        docEl.style.setProperty('--vh', `${viewportHeight * 0.01}px`);

        const targetHeight = Math.max(viewportHeight - chromeHeight, 420);

        if (hero) {
          hero.style.minHeight = `${targetHeight}px`;
        }
      }

      syncHeroHeight();
      window.addEventListener('load', syncHeroHeight, { once: true });
      window.addEventListener('resize', syncHeroHeight, { passive: true });
      window.addEventListener('orientationchange', syncHeroHeight);
      window.addEventListener('pageshow', (event) => {
        if (event.persisted) {
          syncHeroHeight();
        }
      });
      window.setTimeout(syncHeroHeight, 150);

      const aboutCard = document.querySelector('#about-card');
      if (!aboutCard || !('IntersectionObserver' in window)) {
          if (aboutCard) {
              aboutCard.classList.add('is-visible');
          }
          return;
      }
      const observer = new IntersectionObserver((entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            entry.target.classList.add('is-visible');
            observer.unobserve(entry.target);
          }
        });
      }, { threshold: 0.2 });
      observer.observe(aboutCard);
    });
  </script>
{% endblock %}

{% block content %}
{% set bg_url = url_for('static', filename='img/fnirs_channel_data_2_transparent_new.png') %}
<div class="index-bg" aria-hidden="true" style="background-image: url('{{ bg_url }}');"></div>
<noscript>
  <img class="index-bg__fallback" src="{{ bg_url }}" alt="" aria-hidden="true">
</noscript>


<section class="index-hero text-center text-gray-100 flex flex-col items-center justify-center">
  <div class="index-hero__overlay" aria-hidden="true"></div>
  <h1 class="text-5xl font-extrabold leading-tight">
    Hemodynamics and Neural Activity<br> Illuminated
  </h1>
</section>

<section id="about" class="about-section relative px-4 sm:px-6 md:px-10 pt-10 pb-32 flex justify-center">
  <div id="about-card" class="bg-white dark:bg-slate-900/70 rounded-3xl shadow-2xl border border-indigo-100/60 dark:border-indigo-900/60 transition-all duration-700 ease-out">
    <div class="px-6 sm:px-10 py-12">
      {% include "partials/about_section.html" %}
    </div>
  </div>
</section>
{% endblock %}
